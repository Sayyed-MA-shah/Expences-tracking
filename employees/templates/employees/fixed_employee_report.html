{% extends "base.html" %}
{% block content %}
<div class="max-w-5xl mx-auto bg-white p-6 rounded-xl shadow space-y-6">

  <!-- Header -->
  <div class="flex justify-between items-center border-b pb-3 no-print">
    <h2 class="text-2xl font-bold text-gray-800">
      {{ employee.name }} â€“ <span class="text-gray-600">Fixed Salary Report</span>
    </h2>
    <div class="space-x-2">
      <a href="{% url 'employees:fixed_employee_add_salary' employee.id %}" 
         class="px-4 py-2 bg-green-600 text-white rounded-lg shadow hover:bg-green-700">
         + Add Salary
      </a>
      <button type="button" onclick="window.print()" class="px-4 py-2 bg-green-600 text-white rounded">ðŸ–¨ Print</button>
      <a href="{% url 'employees:fixed_employee_payslip' employee.id %}?start_date={{ start_date }}&end_date={{ end_date }}" 
         class="px-4 py-2 bg-purple-600 text-white rounded-lg shadow hover:bg-purple-700">
         ðŸ§¾ Payslip
      </a>
    </div>
  </div>

  <!-- Employee Info -->
  <div class="grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg">
    <p><strong>ðŸ“ž Phone:</strong> {{ employee.phone }}</p>
    <p><strong>ðŸ‘” Role:</strong> {{ employee.role }}</p>
    <p><strong>ðŸ’° Monthly Salary:</strong> Â£{{ total_salary }}</p>
    <p><strong>ðŸ§¾ Total Paid:</strong> Â£{{ total_paid }}</p>
  </div>

  <!-- Date Filter -->
  <form method="get" class="flex space-x-3 items-center bg-gray-100 p-3 rounded-lg no-print">
    <label class="flex items-center space-x-1">
      <span>From:</span>
      <input type="date" name="start_date" value="{{ start_date }}" class="border rounded p-1">
    </label>
    <label class="flex items-center space-x-1">
      <span>To:</span>
      <input type="date" name="end_date" value="{{ end_date }}" class="border rounded p-1">
    </label>
    <button type="submit" 
            class="px-3 py-1 bg-blue-600 text-white rounded shadow hover:bg-blue-700">Filter</button>
    {% if start_date or end_date %}
    <a href="{% url 'employees:fixed_employee_report' employee.id %}" 
       class="px-3 py-1 bg-gray-300 text-black rounded hover:bg-gray-400">Clear</a>
    {% endif %}
  </form>

  <!-- Payments Table -->
  <div class="overflow-x-auto">
    <table class="w-full border-collapse rounded-lg shadow">
      <thead class="bg-gray-200 text-gray-700">
        <tr>
          <th class="p-2 text-left">Date</th>
          <th class="p-2 text-left">Amount Paid</th>
          <th class="p-1text-left">Action</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y">
        {% for payment in payments %}
        <tr class="hover:bg-gray-50">
          <td class="p-2">{{ payment.date }}</td>
          <td class="p-2 font-semibold text-green-700">Â£{{ payment.amount }}</td>
          
        </tr>
        {% empty %}
        <tr><td colspan="2" class="p-2 text-center text-gray-500">No payments found.</td></tr>
        {% endfor %}
      </tbody>
      <tfoot class="bg-gray-100 font-bold">
        <tr>
          <td class="p-2 text-right">Total Paid:</td>
          <td class="p-2">Â£{{ total_paid }}</td>
        </tr>
        <tr>
          <td class="p-2 text-right">Balance:</td>
          <td class="p-2 {% if balance < 0 %}text-red-600{% else %}text-green-600{% endif %}">Â£{{ balance }}</td>
        </tr>
      </tfoot>
    </table>
  </div>

</div>

<style>
  @media print {
    .no-print { display: none !important; }
    nav, footer { display: none !important; }
    body { background: white !important; }
  }
</style>
{% endblock %}
